# Sistema de GestiÃ³n de Estacionamiento - Parking Lot (VersiÃ³n Simplificada)

## DescripciÃ³n General

Sistema simple de gestiÃ³n de estacionamiento que permite entrada, asignaciÃ³n de espacios, salida y cÃ¡lculo de tarifas para vehÃ­culos. El sistema utiliza patrones de diseÃ±o OOP para mantener una arquitectura limpia, escalable y fÃ¡cil de mantener.

**VersiÃ³n:** Simplificada (sin reservas anticipadas, sin pagos complejos)
**Enfoque:** Educativo - PrÃ¡ctica de Object-Oriented Design (OOD)

---

##  Arquitectura y Patrones de DiseÃ±o

### Patrones Implementados

1. **Facade Pattern** (`ParkingLotFacade`)
   - Proporciona una interfaz simplificada para el usuario
   - Orquesta la interacciÃ³n entre ParkingManager, FareCalculator y Ticket

2. **Manager Pattern** (`ParkingManager`)
   - Gestiona el ciclo de vida de los espacios de estacionamiento
   - Mantiene inventario de espacios disponibles, ocupados, etc.

3. **Strategy Pattern** (`FareCalculator`)
   - Encapsula la lÃ³gica de cÃ¡lculo de tarifas
   - Permite extensiÃ³n futura con diferentes estrategias de precios

4. **Data Class** (Kotlin)
   - `Vehicle`, `ParkingSpace`, `Ticket` como modelos de datos simples

---

## ğŸ“‹ Requisitos Funcionales (Simplificados)

### RF-01: GestiÃ³n de Tipos de VehÃ­culos âœ…

**DescripciÃ³n:** El sistema soporta mÃºltiples tipos de vehÃ­culos.

**Tipos Soportados:**
- `CAR` - AutomÃ³vil (tarifa: $5/hora)
- `MOTORCYCLE` - Motocicleta (tarifa: $2/hora)
- `TRUCK` - CamiÃ³n (tarifa: $10/hora)
- `BUS` - AutobÃºs (tarifa: $1/hora)

**ImplementaciÃ³n:**
```kotlin
enum class TypeVehicle {
    CAR, MOTORCYCLE, TRUCK, BUS
}
```

---

### RF-02: GestiÃ³n de Espacios de Estacionamiento 

**DescripciÃ³n:** El sistema administra espacios fÃ­sicos disponibles.

**Propiedades de un Espacio:**
- `identifier` - ID Ãºnico (ej: "A1", "B5")
- `parkingLevel` - Nivel/piso del estacionamiento
- `spaceType` - Tipo de espacio (NORMAL, HANDICAPPED, COMPACT, OVERSIZED)
- `status` - Estado actual:
   - `AVAILABLE` - Disponible para estacionar
   - `OCCUPIED` - Ocupado por un vehÃ­culo
   - `RESERVED` - Reservado (futuro)
   - `MAINTENANCE` - En mantenimiento
- `availableTypeVehicles` - Lista de tipos de vehÃ­culos permitidos

**Criterios de AceptaciÃ³n:**
- âœ… Se pueden crear espacios de estacionamiento
- âœ… Cada espacio tiene un estado bien definido
- âœ… Se puede consultar disponibilidad en tiempo real
- âœ… Los espacios se asignan automÃ¡ticamente segÃºn tipo de vehÃ­culo

---

### RF-03: Entrada de VehÃ­culo âœ…

**DescripciÃ³n:** Un vehÃ­culo entra al estacionamiento y se le asigna un espacio.

**Flujo:**
```
Usuario llega con vehÃ­culo
        â†“
Sistema busca espacio disponible para ese tipo
        â†“
Â¿Hay espacio?
â”œâ”€ SÃ â†’ Asignar espacio + Crear ticket â†’ Retornar ticket
â””â”€ NO â†’ Retornar null (sin espacios disponibles)
```

**Criterios de AceptaciÃ³n:**
- âœ… Se valida disponibilidad de espacios
- âœ… Se asigna espacio compatible con tipo de vehÃ­culo
- âœ… Se genera ticket Ãºnico con ID
- âœ… Se registra hora de entrada
- âœ… Se cambia estado del espacio a OCCUPIED

**ImplementaciÃ³n:**
```kotlin
fun entry(vehicle: Vehicle): Ticket?
```

---

### RF-04: Salida de VehÃ­culo âœ…

**DescripciÃ³n:** Un vehÃ­culo sale del estacionamiento y se calcula la tarifa.

**Flujo:**
```
Usuario sale del estacionamiento
        â†“
Sistema obtiene su ticket
        â†“
Calcula duraciÃ³n: exitTime - entryTime
        â†“
Calcula tarifa: FareCalculator.calculateFare()
        â†“
Libera espacio (status = AVAILABLE)
        â†“
Retorna tarifa a cobrar
```

**Criterios de AceptaciÃ³n:**
- âœ… Se obtiene ticket del vehÃ­culo
- âœ… Se registra hora exacta de salida
- âœ… Se calcula duraciÃ³n del estacionamiento
- âœ… Se calcula tarifa correctamente
- âœ… Se libera el espacio

**ImplementaciÃ³n:**
```kotlin
fun exit(vehicle: Vehicle): Double?  // Retorna tarifa a cobrar
```

---

### RF-05: CÃ¡lculo de Tarifas 

**DescripciÃ³n:** Sistema de precios basado en tipo de vehÃ­culo y duraciÃ³n.

**Modelo de TarificaciÃ³n:**
```
Tarifa Total = Tarifa Base Ã— DuraciÃ³n (en horas)
```

**Tarifas Base:**
| Tipo de VehÃ­culo | Tarifa por hora |
|------------------|-----------------|
| AutomÃ³vil (CAR) | $5.00 |
| Motocicleta (MOTORCYCLE) | $2.00 |
| CamiÃ³n (TRUCK) | $10.00 |
| AutobÃºs (BUS) | $1.00 |

**Ejemplo de CÃ¡lculo:**
```
AutomÃ³vil estacionado 3 horas:
  Tarifa = $5.00 Ã— 3 = $15.00

Motocicleta estacionada 2.5 horas:
  Tarifa = $2.00 Ã— 2 = $4.00 (redondeado a horas)
```

**Criterios de AceptaciÃ³n:**
- âœ… Se calcula tarifa correctamente
- âœ… Considera tipo de vehÃ­culo
- âœ… Considera duraciÃ³n del estacionamiento
- âœ… Lanza excepciÃ³n para tipo de vehÃ­culo desconocido

---

##  Clases Principales

### 1. `Vehicle`
Representa un vehÃ­culo en el sistema.

```kotlin
data class Vehicle(
    val licensePlate: String,      // Placa del vehÃ­culo
    val owner: String,              // DueÃ±o del vehÃ­culo
    var typeVehicle: TypeVehicle   // Tipo de vehÃ­culo
)
```

---

### 2. `ParkingSpace`
Representa un espacio individual de estacionamiento.

```kotlin
data class ParkingSpace(
    val identifier: String,                      // ID Ãºnico (ej: "A1")
    val parkingLevel: Int,                       // Nivel/piso
    val spaceType: SpaceType,                    // Tipo de espacio
    var status: StatusParkingSpace,              // Estado actual
    val availableTypeVehicles: List<TypeVehicle> // Tipos permitidos
)
```

---

### 3. `Ticket`
Representa una sesiÃ³n de estacionamiento.

```kotlin
data class Ticket(
    val ticketId: String,           // ID Ãºnico del ticket
    val vehicle: Vehicle,            // VehÃ­culo estacionado
    val parkingSpace: ParkingSpace,  // Espacio asignado
    val entryTime: LocalDateTime,    // Hora de entrada
    var exitTime: LocalDateTime?     // Hora de salida (null si activo)
)
```

**MÃ©todos:**
- `isActive(): Boolean` - Indica si el vehÃ­culo aÃºn estÃ¡ estacionado
- `getDuration(): Long?` - Calcula duraciÃ³n en horas

---

### 4. `ParkingManager`
Gestor central de espacios de estacionamiento.

```kotlin
class ParkingManager {
    fun addParkingSpace(space: ParkingSpace)
    fun findAvailabeSpaces(typeVehicle: TypeVehicle): ParkingSpace?
    fun getAvailableSpaces(typeVehicle: TypeVehicle): List<ParkingSpace>
    fun getAvailableSpacesCount(typeVehicle: TypeVehicle): Int
    fun hasAvailableSpace(typeVehicle: TypeVehicle): Boolean
    fun releaseSpace(space: ParkingSpace)
    fun getTotalSpaces(): Int
    fun getOccupiedSpaces(): Int
}
```

---

### 5. `FareCalculator`
Calcula tarifas de estacionamiento.

```kotlin
class FareCalculator {
    fun calculateFare(vehicleType: TypeVehicle, durationHours: Long): Double
    fun getBaseFare(vehicleType: TypeVehicle): Double
    fun getAllFares(): Map<TypeVehicle, Double>
}
```

---

### 6. `ParkingLotFacade` 
Facade que simplifica toda la interacciÃ³n con el sistema.

```kotlin
class ParkingLotFacade(
    private val parkingManager: ParkingManager,
    private val fareCalculator: FareCalculator
) {
    fun entry(vehicle: Vehicle): Ticket?
    fun exit(vehicle: Vehicle): Double?
    fun getActiveTicket(licensePlate: String): Ticket?
    fun getActiveSessionsCount(): Int
}
```

---

##  Caso de Uso Completo

### Escenario: Cliente estaciona auto durante 2 horas

```
1. ENTRADA
   Cliente: "Quiero estacionar mi auto (ABC-123)"
   Sistema:
   â”œâ”€ Busca espacio disponible para CAR
   â”œâ”€ Encuentra espacio A1
   â”œâ”€ Crea ticket #12345
   â””â”€ Retorna: "Ticket generado, espacio A1"

2. [Auto estacionado 2 horas]

3. SALIDA
   Cliente: "Me voy"
   Sistema:
   â”œâ”€ Obtiene ticket #12345
   â”œâ”€ Registra salida actual
   â”œâ”€ Calcula duraciÃ³n: 2 horas
   â”œâ”€ Calcula tarifa: $5/hora Ã— 2h = $10
   â”œâ”€ Libera espacio A1
   â””â”€ Retorna: "Tarifa: $10.00"
```

---

## ğŸ“Š Diagrama UML de Clases

Para visualizar el diagrama completo de clases, revisa el archivo: **[diagrama.puml](./diagrama.puml)**

El diagrama incluye:
- âœ… **3 Enums:** TypeVehicle, SpaceType, StatusParkingSpace
- âœ… **6 Clases principales:** Vehicle, ParkingSpace, Ticket, ParkingManager, FareCalculator, ParkingLotFacade
- âœ… **Relaciones entre clases:** Dependencias, composiciÃ³n, asociaciones
- âœ… **Patrones de diseÃ±o anotados:** Facade, Manager, Strategy

**Para visualizar el diagrama PlantUML:**
1. Usa PlantUML en VS Code (extensiÃ³n PlantUML)
2. O copia el contenido en [plantuml.com](https://www.plantuml.com/plantuml/uml/)
3. O usa `plantuml diagrama.puml` en terminal

---

## ğŸ“Š Flujo de Datos Simplificado

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ParkingLotFacade (Facade)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ParkingManager   â”‚      â”‚ FareCalculator       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â€¢ Espacios       â”‚      â”‚ â€¢ Tarifas base       â”‚   â”‚
â”‚  â”‚ â€¢ Disponibilidad â”‚      â”‚ â€¢ CÃ¡lculos           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         Ticket (SesiÃ³n de estacionamiento)      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â€¢ ID                                           â”‚   â”‚
â”‚  â”‚ â€¢ VehÃ­culo                                     â”‚   â”‚
â”‚  â”‚ â€¢ Espacio asignado                             â”‚   â”‚
â”‚  â”‚ â€¢ Tiempos (entrada/salida)                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

##  Estructura del Proyecto

```
src/
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ Vehicle.kt              # Modelo de vehÃ­culo
â”‚   â”œâ”€â”€ ParkingSpace.kt         # Modelo de espacio
â”‚   â”œâ”€â”€ Ticket.kt               # Modelo de ticket
â”‚   â”œâ”€â”€ ParkingManager.kt       # Manager de espacios
â”‚   â”œâ”€â”€ FareCalculator.kt       # Calculador de tarifas
â”‚   â””â”€â”€ ParkingLotFacade.kt     # Facade principal
â”œâ”€â”€ enums/
â”‚   â”œâ”€â”€ TypeVehicle.kt          # Tipos de vehÃ­culos
â”‚   â”œâ”€â”€ SpaceType.kt            # Tipos de espacios
â”‚   â””â”€â”€ StatusParkingSpace.kt   # Estados de espacios
â””â”€â”€ Main.kt                      # Ejemplo de uso
```

---


## ğŸ”„ Diferencias: VersiÃ³n Simplificada vs Completa

| Aspecto | Simplificada âœ… | Completa âŒ |
|--------|-----------|---------|
| **Reservas** | No | SÃ­ (PENDING, CONFIRMED, etc.) |
| **Pagos** | Tarifa simple | Reembolsos, descuentos |
| **Cancelaciones** | No | SÃ­, con polÃ­ticas |
| **No-shows** | No | SÃ­, automÃ¡ticos |
| **AuditorÃ­a** | No | SÃ­, completa |
| **Complejidad** | Baja | Alta |
| **Clases** | 6 principales | 10+ |
| **LÃ­neas de cÃ³digo** | ~400 | ~1000+ |
| **PropÃ³sito** | Aprendizaje OOD | Sistema productivo |

---

```
@author: dgarcia(manuonda)
```